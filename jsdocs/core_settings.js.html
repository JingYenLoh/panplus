<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: core/settings.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: core/settings.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Singleton class
 */

 /**
  * @class Singleton Settings class to manage user settings. Constructor is private.
  */
function Settings() { throw new Error("Please use Settings.requestInstance to initialize Settings."); }
(function() {
    var initiated = false;
    var instance = null;

    /**
     * Private constructor
     * @private
     * @constructor
     * @param {Boolean} subtitlesEnabled 
     * @param {Number} normalPlaybackRate 
     * @param {Boolean} silenceSkipEnabled 
     * @param {Number} silencePlaybackRate 
     */
    function _Settings(subtitlesEnabled = true, 
        normalPlaybackRate = 1.0, 
        silenceSkipEnabled = true) {
        if (!initiated) {
            initiated = true;
            this.subtitlesEnabled = subtitlesEnabled;
            this.normalPlaybackRate = normalPlaybackRate;
            this.silenceSkipEnabled = silenceSkipEnabled;
        }
    }

    /**
     * Request instance using Promises
     */
    Settings.initialize = function() {
        return new Promise((resolve) => {
            if (!initiated) {
                Settings.load().then((result) => {
                    instance = new _Settings();
                    //instance = result;
                    initiated = true;
                    resolve(instance);
                }).catch(() => {
                    instance = new _Settings();
                    resolve(instance);
                });
            } else {
                resolve(instance);
            }
        });
    }
    /** * */ Settings.getSubtitlesEnabled = function() { return instance.subtitlesEnabled; }
    /** * */ Settings.getNormalPlaybackRate = function() { return instance.normalPlaybackRate; }
    /** * */ Settings.getSilenceSkipEnabled = function() { return instance.silenceSkipEnabled; }
    /** *@param {Boolean} val */ 
    Settings.setSubtitlesEnabled = function(val) { 
        instance.subtitlesEnabled = val;
        Settings.save();
    }
    /** *@param {Number} val */ 
    Settings.setNormalPlaybackRate = function(val) { 
        instance.normalPlaybackRate = val;
        Settings.save();
    }
    /** *@param {Boolean} val */ 
    Settings.setSilenceSkipEnabled = function(val) { 
        instance.silenceSkipEnabled = val;
        Settings.save();
    }
    
    /**
     * Load from chrome storage using Promises
     * KIV: segregated settings for each module
     * @returns {Promise}
     */
    Settings.load = function() {
        return new Promise((resolve, reject) => {
            chrome.storage.local.get(['settings'],(res) => {
                if (res['settings']) resolve(res['settings']);
                else reject();
            });
        });
    }
    
    /**
     * Saving of settings into chrome storage
     * * @returns {undefined}
     */
    Settings.save = function() {
        var kvp = {};
        kvp['settings'] = instance;
        chrome.storage.local.set(kvp,() => {});
    }
})();</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ContextBridge.html">ContextBridge</a></li><li><a href="LoggerDisabler.html">LoggerDisabler</a></li><li><a href="Settings.html">Settings</a></li><li><a href="Sidebar.html">Sidebar</a></li><li><a href="SilenceCueManager.html">SilenceCueManager</a></li><li><a href="SpeedSlider.html">SpeedSlider</a></li><li><a href="Subtitles.html">Subtitles</a></li><li><a href="Template.html">Template</a></li><li><a href="Transcript.html">Transcript</a></li><li><a href="TranscriptRequester.html">TranscriptRequester</a></li><li><a href="TranscriptSource.html">TranscriptSource</a></li><li><a href="TranscriptSourcePanopto.html">TranscriptSourcePanopto</a></li><li><a href="TSTracker.html">TSTracker</a></li><li><a href="VADAudioWorkletProcessor.html">VADAudioWorkletProcessor</a></li></ul><h3>Global</h3><ul><li><a href="global.html#resolvePrecept">resolvePrecept</a></li><li><a href="global.html#sleep">sleep</a></li><li><a href="global.html#Uint8ArrayToArrayBuffer">Uint8ArrayToArrayBuffer</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.2</a> on Mon Jun 24 2019 12:00:05 GMT+0800 (Singapore Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
